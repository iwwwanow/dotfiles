# LSP-стек Neovim

Конфигурация перешла с CoC.nvim на нативный LSP-клиент Neovim + Mason + nvim-cmp.
Этот стек не требует Node.js и управляется напрямую средствами Neovim.

## Первичный запуск
1. Открой `nvim` и выполни `:Lazy sync`, чтобы установить новые плагины.
2. После установки набери `:Mason` — появится графический список доступных языковых серверов.
3. Mason уже помечен на автозагрузку серверов: `lua_ls`, `tsserver`, `svelte`,
   `html`, `cssls`, `jsonls`, `bashls`, `clangd`. Для остальных языков
   воспользуйся `:MasonInstall <server>`.
4. При необходимости перегенерируй lock-файл через `:Lazy lock`, чтобы зафиксировать версии.

## Ключевые бинды LSP
- `K` — hover-документация.
- `<leader>gd` / `<leader>gr` / `<leader>gi` / `<leader>gy` — переход к определению,
  ссылкам, реализации и типу соответственно.
- `<leader>rn` — переименовать символ.
- `<leader>a` или `<leader>ca` — code action (также работает в визуальном режиме).
- `<leader>D` — повтор hover в духе старого `show_docs` из CoC.
- `<leader>cl` — запуск LSP CodeLens там, где поддерживается.
- `[g` / `]g` — навигация по диагностике.
- `<leader>f` или команда `:Format` — форматирование текущего буфера через сервер.
- По наведению и лёгкой паузе (см. `updatetime`) автоматически всплывает окно
  c диагностикой; подсказки под курсором показываются в виртуальном тексте и
  всплывающем окне.

## Автодополнение
Дополнение управляется `nvim-cmp` + `LuaSnip`.

- Нажми `<C-Space>` для показа списка.
- `<Tab>` и `<S-Tab>` переключают элементы и прыгают по сниппетам.
- `<CR>` принимает текущий элемент (без автоподстановки, как было в CoC).

Если нужен набор готовых сниппетов — `friendly-snippets` ставится автоматически.

## Tree-sitter
Автоматическая установка парсеров отключена, чтобы Neovim не пытался скачивать
их при каждом старте в окружениях без сети. Для нужных языков установи парсер
вручную: `:TSInstall <lang>`. Список языков, которые раньше ставились
автоматически, лежит в таблице `vim.g.treesitter_managed_languages` — можно
подсмотреть и поставить только необходимые (`:lua vim.print(vim.g.treesitter_managed_languages)`).

## Управление серверами и форматтерами
- `:Mason` — общий список пакетов (LSP, форматтеры, линтеры, DAP).
- `:MasonInstall <pkg>` / `:MasonUninstall <pkg>` — установка и удаление.
- Файлы конфигурации серверов см. в `lua/plugins/lsp.lua`.
  При необходимости добавь новые элементы в таблицу `servers`.

## Что больше не используется
- Файл `coc-settings.json` сохранён для истории, но на работу Neovim не влияет.
  Можно удалить или оставить как справочник.

## Расширение конфигурации
- Для дополнительных источников автодополнения добавь их в `lua/plugins/cmp.lua`.
- Чтобы изменить hotkeys, дополни функцию `lsp_keymaps` в `lua/plugins/lsp.lua`.
- Если нужен специфический язык, которому нет пакета в Mason, настрой его напрямую
  через `lspconfig["server"].setup({ ... })` в том же модуле.
